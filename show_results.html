<!doctype html>
<html>
	<head>
		<title>Your Results</title>
		<!-- load in JS file , full min includes d3 for us -->
		<script src="https://d3plus.org/js/d3plus.full.min.js"></script>
<link href='https://fonts.googleapis.com/css?family=Pathway+Gothic+One' rel='stylesheet' type='text/css'>
        <link type="text/css" rel="stylesheet" media="all" href="styles.css" />

        <style>
        	#res_text{
        		text-align: center;
        		font-size: 26pt;

        	}
			#parent{
        		text-align: center;
    			overflow:hidden;
    			position:relative;
    			display:table;
    			width:100%;
    			height:300px;
			}
			.left{
    			width:40%;
   				display:table-cell;
			}
			.right{
				width:60%;
    			display:table-cell;
			}

			body{
    			margin:0;
    			padding:0;
			}

		</style>
	</head>

	<body>
	<div id="res_text">
       You should be a(n)<br>
       <h1 id="top_job"></h1>
       </div>

	<div id="parent">
		<div class="left" id="res1left">Top 5 Occupations</div>
		<div class="right" id="res1right">Your Skills</div>	

	</div>
        
    <h2>Check out more at <a href="http://datausa.io">DataUSA</a> </h2>
    <div id="res2">
        <iframe id="iframe_dusa" width="100%" height = "600px" frameborder="0"></iframe></div>

	</body>

	<script>

	function datafold(json) {
		var return_data = json.data.map(function(data) {
			return json.headers.reduce(function(obj, header, i) {
				obj[header] = data[i];
				return obj;
			}, {});
		});
		console.log(return_data)
		return return_data
	}
        
    function update_plot(data) {
        d3.select("#top_job").html(data[0].name); // update the job name
         
		var myViz = d3plus.viz()
				.container("#res1left")
                .data(data)
				.type("bar")
                .x("score")
                .y("name")
				.id("name")
                .y({scale: "discrete"})
                .mouse({click: function(obj) {
                     var cURL = "http://datausa.io/profile/soc/".concat(obj.SOC)

                    console.log("Loading new URL: ", cURL)
                    d3.select("#iframe_dusa").attr("src", cURL);
                }})
                .order("score")
                .order({sort: "asc"})
				.draw();
		return null
	}
        

	var data = [
		{"SOC": 272011, "score": 0.997,"name": "Actor", "value": 55},
		{"SOC": 532010, "score": 0.80,"name": "Commercial Airline Pilot", "value": 25},
		{"SOC": 291020, "score": 0.5,"name": "Dentist", "value": 20},
		{"SOC": 252030, "score": 0.4,"name": "Secondary School Teacher", "value": 20},
		{"SOC": 132051, "score": 0.3,"name": "Financial Analyst", "value": 20}

	];
    
	d3.select("#iframe_dusa").attr("src", "http://datausa.io/profile/soc/".concat(data[0].SOC));
	update_plot(data);

	var myViz = d3plus.viz()
				.container("#res1right")
                .data(data)
				.type("bar")
                .x("score")
                .y("name")
				.id("name")
                .y({scale: "discrete"})
                .mouse({click: function(obj) {
                     var cURL = "http://datausa.io/profile/soc/".concat(obj.SOC)

                    console.log("Loading new URL: ", cURL)
                    d3.select("#iframe_dusa").attr("src", cURL);
                }})
                .order("score")
                .order({sort: "desc"})
				.draw();
    
	</script>


</html>